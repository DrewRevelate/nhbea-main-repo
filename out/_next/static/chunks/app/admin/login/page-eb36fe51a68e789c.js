(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2116,6104],{35695:(e,a,r)=>{"use strict";var s=r(18999);r.o(s,"usePathname")&&r.d(a,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(a,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(a,{useSearchParams:function(){return s.useSearchParams}})},56104:(e,a,r)=>{"use strict";r.d(a,{Ay:()=>h,IG:()=>d,db:()=>u,j2:()=>m});var s=r(23915),t=r(35317),n=r(77505),i=r(45404);let l={apiKey:"AIzaSyC08Pd4oC3bTOKFnNXQtgCUx8YVVczpXZM",authDomain:"nhbea-64cab.firebaseapp.com",projectId:"nhbea-64cab",storageBucket:"nhbea-64cab.firebasestorage.app",messagingSenderId:"956870811159",appId:"1:956870811159:web:825f4c67fa29b6e1cac652"},o=!!(l.apiKey&&l.authDomain&&l.projectId&&l.storageBucket&&l.messagingSenderId&&l.appId);o||console.error("Firebase configuration is incomplete. Required fields:",{apiKey:!!l.apiKey,authDomain:!!l.authDomain,projectId:!!l.projectId,storageBucket:!!l.storageBucket,messagingSenderId:!!l.messagingSenderId,appId:!!l.appId});let c=null,u=null,d=null,m=null;if(o)try{c=0===(0,s.Dk)().length?(0,s.Wp)(l):(0,s.Sx)(),u=(0,t.aU)(c),d=(0,n.c7)(c),m=(0,i.xI)(c),console.log("✅ Firebase initialized successfully")}catch(e){console.error("❌ Failed to initialize Firebase:",e)}else console.warn("⚠️ Firebase not initialized - missing configuration");let h=c},70593:(e,a,r)=>{"use strict";r.d(a,{b:()=>u});var s=r(12115),t=r(35695),n=r(45404),i=r(35317),l=r(56104);class o extends Error{constructor(e,a){super(e),this.code=a,this.name="AdminAuthError"}}let c={async signIn(e,a){try{let r=(0,n.xI)(),s=(await (0,n.x9)(r,e,a)).user,t=await this.getAdminUser(s.uid);if(!t)throw await (0,n.CI)(r),new o("User is not authorized as an admin","UNAUTHORIZED");if(!t.isActive)throw await (0,n.CI)(r),new o("Admin account is deactivated","ACCOUNT_DISABLED");return await this.updateLastLogin(t.uid),{adminUserId:t.uid,email:t.email,displayName:t.displayName,role:t.role,permissions:t.permissions,expiresAt:Date.now()+864e5}}catch(e){if(e instanceof o)throw e;switch(e.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":throw new o("Invalid email or password","INVALID_CREDENTIALS");case"auth/too-many-requests":throw new o("Too many failed attempts. Please try again later.","TOO_MANY_REQUESTS");default:throw new o("Authentication failed","AUTH_ERROR")}}},async signOut(){let e=(0,n.xI)();await (0,n.CI)(e)},async getAdminUser(e){try{let a=await (0,i.x7)((0,i.doc)(l.db,"admin_users",e));if(!a.exists())return null;return a.data()}catch(e){return console.error("Error fetching admin user:",e),null}},async updateLastLogin(e){try{let{updateDoc:a,doc:s,serverTimestamp:t}=await Promise.resolve().then(r.bind(r,35317));await a(s(l.db,"admin_users",e),{lastLogin:t()})}catch(e){console.error("Error updating last login:",e)}},getCurrentUser:()=>(0,n.xI)().currentUser,async validateSession(e){if(!e||Date.now()>e.expiresAt)return!1;let a=await this.getAdminUser(e.adminUserId);return(null==a?void 0:a.isActive)===!0}},u=()=>{let[e,a]=(0,s.useState)({user:null,adminUser:null,session:null,loading:!0,error:null}),r=(0,t.useRouter)(),i=(0,s.useCallback)(e=>{a(a=>({...a,error:e}))},[]),l=(0,s.useCallback)(e=>{a(a=>({...a,loading:e}))},[]);(0,s.useEffect)(()=>{let e=(0,n.xI)();return(0,n.hg)(e,async e=>{try{if(l(!0),i(null),e){let r=await c.getAdminUser(e.uid);if(r&&r.isActive){let s={adminUserId:r.uid,email:r.email,displayName:r.displayName,role:r.role,permissions:r.permissions,expiresAt:Date.now()+864e5};a({user:e,adminUser:r,session:s,loading:!1,error:null})}else a({user:null,adminUser:null,session:null,loading:!1,error:r?"Admin account is deactivated":"Unauthorized access"})}else a({user:null,adminUser:null,session:null,loading:!1,error:null})}catch(e){console.error("Auth state change error:",e),a({user:null,adminUser:null,session:null,loading:!1,error:"Authentication error occurred"})}})},[]);let u=(0,s.useCallback)(async(e,a)=>{try{return l(!0),i(null),await c.signIn(e,a),r.push("/admin"),{success:!0}}catch(a){let e=a instanceof o?a.message:"An unexpected error occurred";return i(e),l(!1),{success:!1,error:e}}},[r]),d=(0,s.useCallback)(async()=>{try{l(!0),await c.signOut(),r.push("/admin/login")}catch(e){console.error("Sign out error:",e),i("Failed to sign out")}finally{l(!1)}},[r]),m=(0,s.useCallback)(async()=>{if(!e.session)return!1;try{if(!await c.validateSession(e.session))return await d(),!1;return!0}catch(e){return console.error("Session refresh error:",e),await d(),!1}},[e.session,d]);return(0,s.useEffect)(()=>{if(!e.session)return;let a=setInterval(()=>{m()},3e5);return()=>clearInterval(a)},[e.session,m]),{user:e.user,adminUser:e.adminUser,session:e.session,loading:e.loading,error:e.error,isAuthenticated:!!e.user&&!!e.adminUser,isAuthorized:!!e.session,signIn:u,signOut:d,refreshSession:m,clearError:()=>i(null)}}},75430:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>l});var s=r(95155),t=r(12115),n=r(35695),i=r(70593);function l(){let[e,a]=(0,t.useState)(""),[r,l]=(0,t.useState)(""),[o,c]=(0,t.useState)(!1),{signIn:u,loading:d,error:m,isAuthenticated:h}=(0,i.b)(),p=(0,n.useRouter)();if(h)return p.push("/admin"),null;let g=async a=>{if(a.preventDefault(),e.trim()&&r.trim()){c(!0);try{if((await u(e.trim(),r)).success)return}catch(e){console.error("Login error:",e)}finally{c(!1)}}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",style:{backgroundColor:"var(--nhbea-gray-100)"},children:(0,s.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mx-auto h-12 w-12 rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--nhbea-royal-blue)"},children:(0,s.jsx)("svg",{className:"h-6 w-6 text-[var(--nhbea-gray-50)]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,s.jsx)("h2",{className:"mt-6 text-center heading-1",style:{color:"var(--nhbea-royal-blue-deeper)"},children:"NHBEA Admin Portal"}),(0,s.jsx)("p",{className:"mt-2 text-center text-sm",style:{color:"var(--nhbea-gray-600)"},children:"Sign in to manage website content"})]}),(0,s.jsx)("div",{className:"nhbea-card",children:(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:g,children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"nhbea-form-field",children:[(0,s.jsx)("label",{htmlFor:"email",className:"nhbea-form-label nhbea-form-required",children:"Email address"}),(0,s.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>a(e.target.value),className:"nhbea-form-input",placeholder:"Enter your email",disabled:d||o})]}),(0,s.jsxs)("div",{className:"nhbea-form-field",children:[(0,s.jsx)("label",{htmlFor:"password",className:"nhbea-form-label nhbea-form-required",children:"Password"}),(0,s.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:r,onChange:e=>l(e.target.value),className:"nhbea-form-input",placeholder:"Enter your password",disabled:d||o})]})]}),m&&(0,s.jsx)("div",{className:"nhbea-form-error",children:m}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:d||o||!e.trim()||!r.trim(),className:"nhbea-button-primary w-full flex justify-center items-center",style:{opacity:d||o||!e.trim()||!r.trim()?.5:1},children:d||o?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-4 w-4 text-[var(--nhbea-gray-50)]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})})]})})]})})}},84448:(e,a,r)=>{Promise.resolve().then(r.bind(r,75430))}},e=>{e.O(0,[9135,3965,3155,7748,8441,5964,7358],()=>e(e.s=84448)),_N_E=e.O()}]);